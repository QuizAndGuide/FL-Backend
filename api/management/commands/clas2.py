from django.core.management.base import BaseCommand
from api.serializers import ClasificacionSerializer
import json

data = {'table': [{'id': '2107', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Real Madrid', 'points': '25', 'wins': 8, 'draws': 1, 'losses': 1, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2107.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'real-madrid', 'gf': '21', 'ga': '7', 'avg': 14, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 1, 'class_mark': 'campeon', 'round': '11', 'pos': '1', 'countrycode': 'ES', 'abbr': 'RMA', 'form': 'lwwwd', 'direction': ''}, {'id': '1236', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Girona', 'points': '25', 'wins': 8, 'draws': 1, 'losses': 1, 'shield': 'https://t.resfu.com/img_data/escudos/medium/1236.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'girona-fc', 'gf': '24', 'ga': '13', 'avg': 11, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 2, 'class_mark': 'cha', 'round': '11', 'pos': '2', 'countrycode': 'ES', 'abbr': 'GIR', 'form': 'wwlww', 'direction': ''}, {'id': '429', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Barcelona', 'points': '24', 'wins': 7, 'draws': 3, 'losses': 0, 'shield': 'https://t.resfu.com/img_data/escudos/medium/429.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'barcelona', 'gf': '22', 'ga': '10', 'avg': 12, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 2, 'class_mark': 'cha', 'round': '11', 'pos': '3', 'countrycode': 'ES', 'abbr': 'FCB', 'form': 'wdwdw', 'direction': ''}, {'id': '369', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Atlético', 'points': '22', 'wins': 7, 'draws': 1, 'losses': 1, 'shield': 'https://t.resfu.com/img_data/escudos/medium/369.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'atletico-madrid', 'gf': '23', 'ga': '8', 'avg': 15, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 2, 'class_mark': 'cha', 'round': '11', 'pos': '4', 'countrycode': 'ES', 'abbr': 'ATM', 'form': 'wwwww', 'direction': ''}, {'id': '2120', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Real Sociedad', 'points': '18', 'wins': 5, 'draws': 3, 'losses': 2, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2120.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'real-sociedad', 'gf': '18', 'ga': '12', 'avg': 6, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 3, 'class_mark': 'uefa', 'round': '11', 'pos': '5', 'countrycode': 'ES', 'abbr': 'RSO', 'form': 'wwwlw', 'direction': ''}, {'id': '347', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Athletic', 'points': '17', 'wins': 5, 'draws': 2, 'losses': 3, 'shield': 'https://t.resfu.com/img_data/escudos/medium/347.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'athletic-bilbao', 'gf': '16', 'ga': '10', 'avg': 6, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 5, 'class_mark': 'elimconf', 'round': '11', 'pos': '6', 'countrycode': 'ES', 'abbr': 'ATH', 'form': 'wdlwl', 'direction': ''}, {'id': '2080', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Rayo Vallecano', 'points': '16', 'wins': 4, 'draws': 4, 'losses': 2, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2080.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'rayo-vallecano', 'gf': '12', 'ga': '13', 'avg': -1, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '7', 'countrycode': 'ES', 'abbr': 'RAY', 'form': 'ddddw', 'direction': ''}, {'id': '2647', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Valencia', 'points': '14', 'wins': 4, 'draws': 2, 'losses': 4, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2647.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'valencia-cf', 'gf': '12', 'ga': '11', 'avg': 1, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '8', 'countrycode': 'ES', 'abbr': 'VCF', 'form': 'dlldw', 'direction': ''}, {'id': '486', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Real Betis', 'points': '14', 'wins': 3, 'draws': 5, 'losses': 2, 'shield': 'https://t.resfu.com/img_data/escudos/medium/486.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'betis', 'gf': '12', 'ga': '14', 'avg': -2, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '9', 'countrycode': 'ES', 'abbr': 'BET', 'form': 'ddwdd', 'direction': ''}, {'id': '1887', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Osasuna', 'points': '13', 'wins': 4, 'draws': 1, 'losses': 5, 'shield': 'https://t.resfu.com/img_data/escudos/medium/1887.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'osasuna', 'gf': '11', 'ga': '14', 'avg': -3, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '10', 'countrycode': 'ES', 'abbr': 'OSA', 'form': 'dlwlw', 'direction': ''}, {'id': '1217', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Getafe', 'points': '11', 'wins': 2, 'draws': 5, 'losses': 3, 'shield': 'https://t.resfu.com/img_data/escudos/medium/1217.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'getafe', 'gf': '13', 'ga': '16', 'avg': -3, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '11', 'countrycode': 'ES', 'abbr': 'GET', 'form': 'ldddd', 'direction': ''}, {'id': '2563', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Las Palmas', 'points': '11', 'wins': 3, 'draws': 2, 'losses': 5, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2563.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'ud-palmas', 'gf': '6', 'ga': '9', 'avg': -3, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '12', 'countrycode': 'ES', 'abbr': 'UDL', 'form': 'wlwwl', 'direction': ''}, {'id': '1102', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Sevilla', 'points': '9', 'wins': 2, 'draws': 3, 'losses': 4, 'shield': 'https://t.resfu.com/img_data/escudos/medium/1102.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'sevilla', 'gf': '14', 'ga': '13', 'avg': 1, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '13', 'countrycode': 'ES', 'abbr': 'SEV', 'form': 'dwldd', 'direction': ''}, {'id': '2716', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Villarreal', 'points': '9', 'wins': 2, 'draws': 3, 'losses': 5, 'shield': 'https://t.resfu.com/img_data/escudos/medium/2716.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'villarreal', 'gf': '12', 'ga': '16', 'avg': -4, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '14', 'countrycode': 'ES', 'abbr': 'VIL', 'form': 'dldld', 'direction': ''}, {'id': '603', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Cádiz', 'points': '9', 'wins': 2, 'draws': 3, 'losses': 5, 'shield': 'https://t.resfu.com/img_data/escudos/medium/603.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'cadiz', 'gf': '8', 'ga': '14', 'avg': -6, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '15', 'countrycode': 'ES', 'abbr': 'CAD', 'form': 'ddlll', 'direction': ''}, {'id': '137', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Deportivo Alavés', 'points': '9', 'wins': 2, 'draws': 3, 'losses': 5, 'shield': 'https://t.resfu.com/img_data/escudos/medium/137.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'alaves', 'gf': '8', 'ga': '14', 'avg': -6, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '16', 'countrycode': 'ES', 'abbr': 'ALA', 'form': 'ldldd', 'direction': ''}, {'id': '1623', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Mallorca', 'points': '8', 'wins': 1, 'draws': 5, 'losses': 4, 'shield': 'https://t.resfu.com/img_data/escudos/medium/1623.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'mallorca', 'gf': '12', 'ga': '16', 'avg': -4, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': '', 'class_mark': '', 'round': '11', 'pos': '17', 'countrycode': 'ES', 'abbr': 'MLL', 'form': 'ldddl', 'direction': ''}, {'id': '712', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Celta', 'points': '6', 'wins': 1, 'draws': 3, 'losses': 6, 'shield': 'https://t.resfu.com/img_data/escudos/medium/712.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'celta', 'gf': '10', 'ga': '18', 'avg': -8, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 6, 'class_mark': 'desc', 'round': '11', 'pos': '18', 'countrycode': 'ES', 'abbr': 'CEL', 'form': 'ldldl', 'direction': ''}, {'id': '4235', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Granada', 'points': '6', 'wins': 1, 'draws': 3, 'losses': 6, 'shield': 'https://t.resfu.com/img_data/escudos/medium/4235.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'granada', 'gf': '15', 'ga': '25', 'avg': -10, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 6, 'class_mark': 'desc', 'round': '11', 'pos': '19', 'countrycode': 'ES', 'abbr': 'GRA', 'form': 'ldddl', 'direction': ''}, {'id': '183', 'group': '1', 'group_name': None, 'conference': '0', 'team': 'Almería', 'points': '3', 'wins': 0, 'draws': 3, 'losses': 7, 'shield': 'https://t.resfu.com/img_data/escudos/medium/183.jpg?size=120x&lossy=1&v=36', 'cflag': 'https://t.resfu.com/media/img/flags/st3/large/es.png?size=100x65c&lossy=1&v=36', 'basealias': 'almeria', 'gf': '13', 'ga': '29', 'avg': -16, 'matchs_coef': '', 'points_coef': '', 'coef': '', 'coefficients': None, 'mark': 6, 'class_mark': 'desc', 'round': '11', 'pos': '20', 'countrycode': 'ES', 'abbr': 'ALM', 'form': 'dldll', 'direction': ''}], 'info': {'type': 'Regular', 'type_id': '4'}, 'legends': [{'group': '1', 'legend': [{'pos': 1, 'title': 'Campeón', 'class_color': 'campeon'}, {'pos': 2, 'title': 'Champions League', 'class_color': 'cha'}, {'pos': 3, 'title': 'Europa League', 'class_color': 'uefa'}, {'pos': 5, 'title': 'Fase Eliminatoria Conference League', 'class_color': 'elimconf'}, {'pos': 6, 'title': 'Descenso', 'class_color': 'desc'}], 'penalty': []}]}


class Command(BaseCommand):
    help = 'Guardar la clasificación actual'

    def handle(self, *args, **kwargs):
        try:
            # Aquí obtienes los datos de alguna fuente externa (por ejemplo, un archivo JSON o una API)
            clas_data = data['table']
            
            for n in clas_data:
                serializer = ClasificacionSerializer(data=n)
            if serializer.is_valid():
                serializer.save()
            else:
                # Registra errores en la consola
                self.stderr.write(f'Error al guardar datos: {serializer.errors}')
        except Exception as e:
            # Captura y registra errores generales
            self.stderr.write(f'Error general: {str(e)}')
